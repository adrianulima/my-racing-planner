import{j as e,l as u,m as p,v as D,a as w,T as c,D as I,r as h,t as S,F as R,N as O,O as z,u as A,I as W,n as F,P as B,Q as H,S as g,U as k,f as M,K as V,p as N}from"./index-x8IrEc5F.js";import{P as _}from"./page-header-BBzbh8l0.js";import{g as L,S as C}from"./useSeason-CnZ23Fo6.js";import{u as y,i as T,j as m,E as P,k as G,S as U,e as Y,l as K,m as $,h as J,g as b,n as q,I as Q,P as X,a as Z,b as ee,V as se,T as te,c as ne,d as v}from"./content-checkbox-BUgB6oAL.js";import{S as E}from"./tracks-CVKV-Bu9.js";import{C as re,V as oe}from"./content-name-badge-DSsam6OG.js";import{S as ie}from"./cars-BRIct95o.js";import{F as j}from"./index-B10oFVEB.js";function ae(){return e.jsx(u,{padding:{base:"unset",md:4},justifyContent:"space-between",alignItems:"start",children:e.jsx(_,{title:"Shop Guide",description:`See the tracks most used by your favorite series. Checkout your
          wishlist items at iracing.com`})})}function le(){const{favoriteSeries:s}=y();return e.jsx(T,{bgColor:"transparent",children:e.jsx(m,{colSpan:8,minWidth:"100%",children:e.jsx(P,{icon:e.jsx(p,{icon:D}),title:s.length>0?"No paid tracks missing":"No series selected",description:s.length>0?"You already own all tracks of your favorite series":"You didn't choose any favorite series"})})})}function ce({item:s}){const{myTracks:i,wishTracks:r}=y();return e.jsxs(T,{bgColor:"transparent",children:[e.jsx(m,{textAlign:"center",p:0,borderBottom:0,px:"4px",children:e.jsx(G,{size:"sm",mt:"2px",content:"tracks",sku:s.sku,free:!1,owned:i.includes(s==null?void 0:s.sku),wish:r.includes(s==null?void 0:s.sku)})}),e.jsx(m,{width:"100%",display:"flex",p:1,borderBottom:0,px:"4px",children:e.jsx(re,{name:s.name})}),e.jsx(m,{textAlign:"center",p:1,borderBottom:0,px:"4px",children:e.jsx(w,{lazyMount:!0,unmountOnExit:!0,content:Object.keys(s.weeks).map(a=>e.jsxs(u,{justifyContent:"space-between",children:[e.jsx(c,{textAlign:"left",truncate:!0,children:U[a.toString()].name}),e.jsx(c,{textAlign:"right",children:s.weeks[parseInt(a)].join(", ")})]},a)),showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,children:e.jsxs(I,{size:"xs",variant:"solid",_light:{bg:"gray.600"},children:[s.used,"x"]})})})]})}function de(){const{wishTracks:s,favoriteSeries:i}=y(),r=h.useMemo(()=>i.reduce((t,o)=>{const l=U[o.toString()];return l.weeks.forEach(x=>{const d=Y[x.track.id.toString()];if(d.free)return t;const n="group"in d?d.group:d.id;t[n]=t[n]??{id:n,name:d.name,sku:d.sku,weeks:{},used:0};const f=L(x.date);t[n].weeks[l.id]=t[n].weeks[l.id]??[],t[n].weeks[l.id].push(f),t[n].used++},null),t},{}),[i]),a=h.useMemo(()=>Object.values(r).sort((t,o)=>o.used+Object.keys(o.weeks).length-(t.used+Object.keys(t.weeks).length)).concat(s.map(t=>{const o=E.find(l=>l.sku===t);return o&&!(o.id in r)?{id:o.id,name:o.name,sku:o.sku,weeks:{},used:0}:null}).filter(t=>!!t)),[r]);return e.jsx(S,{flex:1,borderRadius:"md",overflowY:"auto",maxH:"100%",h:"100%",alignItems:"start",children:e.jsx(K,{borderRadius:"md",width:"100%",overflowX:"hidden",children:e.jsxs($,{striped:!0,stickyHeader:!0,children:[e.jsx(J,{children:e.jsxs(T,{bgColor:"bg.muted",children:[e.jsx(b,{textAlign:"center",children:e.jsx(oe,{children:"Owned content"})}),e.jsx(b,{width:"100%",children:"Name"}),e.jsx(b,{textAlign:"center",children:"Used"})]})}),e.jsx(q,{children:e.jsx(R,{fallback:e.jsx(le,{}),each:a,children:t=>e.jsx(ce,{item:t},t.id)})})]})})})}function ue({wishList:s}){return e.jsxs(O,{as:"a",disabled:s.length<1,size:"lg",href:s.length>0?`${Q.store}?skus=${s.map(i=>i.sku)}`:void 0,target:"_blank",rel:"noreferrer",colorPalette:"blue",children:["Checkout on iRacing.com store",e.jsx(p,{icon:z})]})}function he(){const{shopLoyaltyDiscount:s,shopVolumeDiscount:i}=A();return e.jsxs(X,{positioning:{placement:"left-start"},children:[e.jsx(Z,{asChild:!0,children:e.jsx(W,{"aria-label":"Settings",variant:"outline",size:"lg",bgColor:{base:"bg.muted",_hover:"bg"},borderRadius:"md",children:e.jsx(p,{icon:F})})}),e.jsx(ee,{children:e.jsxs(se,{alignItems:"start",p:2,children:[e.jsx(w,{lazyMount:!0,unmountOnExit:!0,content:"Apply iRacing discounts for bundle purchases",showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,ids:{trigger:"volumeDiscount"},children:e.jsx(C,{ids:{root:"volumeDiscount"},checked:i,onCheckedChange:({checked:r})=>B(r),children:"Volume discount"})}),e.jsx(w,{lazyMount:!0,unmountOnExit:!0,content:"Apply iRacing loyalty discount",showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,ids:{trigger:"loyaltyDiscount"},children:e.jsx(C,{ids:{root:"loyaltyDiscount"},checked:s,onCheckedChange:({checked:r})=>H(r),children:"Loyalty discount"})})]})})]})}function xe(){const{wishCars:s,wishTracks:i}=y(),{shopLoyaltyDiscount:r,shopVolumeDiscount:a}=A(),t=h.useMemo(()=>E.filter(n=>i.includes(n.sku)).map(n=>({...n,isCar:!1})).concat(ie.filter(n=>s.includes(n.sku)).map(n=>({...n,isCar:!0}))),[i,s]),o=h.useMemo(()=>t.reduce((n,f)=>n+f.price,0),[t]),l=r?20:a?t.length<3?0:t.length<6?10:t.length<20?15:20:0,x=o*l/100,d=o-x;return e.jsxs(g,{flex:1,borderRadius:"md",w:"100%",h:"100%",maxH:"100%",bgColor:"bg.muted",p:4,children:[e.jsxs(u,{justifyContent:"space-between",children:[e.jsx(c,{textStyle:"3xl",children:"Wishlist"}),e.jsx(he,{})]}),e.jsxs(g,{overflowY:"auto",flex:1,children:[e.jsx(k,{}),e.jsx(R,{fallback:e.jsx(P,{icon:e.jsx(p,{icon:D}),title:"Empty wishlist",description:"Add some cars or tracks to your wishlist"}),each:t,children:n=>e.jsxs(h.Fragment,{children:[e.jsxs(u,{children:[e.jsx(p,{icon:n.isCar?M:V,size:"sm"}),e.jsx(S,{flex:1,children:n.name}),e.jsx(j,{style:"currency",currency:"USD",value:n.price})]}),e.jsx(k,{})]},n.id)})]}),e.jsxs(u,{mt:2,justifyContent:"space-between",fontWeight:"bold",alignItems:"end",children:[e.jsx(c,{textStyle:"4xl",children:"Total"}),e.jsxs(g,{alignItems:"end",gap:0,children:[(a||r)&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{color:"gray",children:[e.jsx(j,{style:"currency",currency:"USD",value:o}),e.jsx(c,{children:"-"}),e.jsx(j,{style:"currency",currency:"USD",value:x})]}),e.jsxs(c,{color:"gray",textAlign:"center",textStyle:"xs",fontWeight:"normal",children:[l,"% discount (",r?"loyalty":`${t.length} items`,")"]}),e.jsx(k,{mt:2})]}),e.jsx(c,{fontSize:"2xl",children:e.jsx(j,{style:"currency",currency:"USD",value:d})})]})]}),e.jsx(ue,{wishList:t})]})}function we(){const[s,i]=h.useState("TracksUsed"),{size:r}=N();return e.jsxs(S,{direction:"column",height:"100%",width:"100%",gap:"8px",children:[e.jsx(ae,{}),e.jsx(g,{hideFrom:"md",children:e.jsx(te,{size:"sm",value:s,onValueChange:a=>i(a.value),variant:"enclosed",width:"100%",flex:1,children:e.jsxs(ne,{flex:1,width:"100%",children:[e.jsx(v,{value:"TracksUsed",width:"100%",children:e.jsx(c,{textWrap:"nowrap",children:"Tracks Used"})}),e.jsx(v,{value:"WishlistPanel",width:"100%",children:e.jsx(c,{textWrap:"nowrap",children:"Wishlist"})})]})})}),e.jsxs(u,{flex:1,alignItems:"start",overflow:"hidden",gap:2,children:[(s==="TracksUsed"||r.md)&&e.jsx(de,{}),(s==="WishlistPanel"||r.md)&&e.jsx(xe,{})]})]})}export{we as default};
