import{j as e,B as W,n as a,u as k,p as C,k as p,q as R,T as g,H as h,C as B,r as j,F as A,a as P,I as V,l as F,S as M,v as H,U,V as _,W as N,X as w,Y as S,f as L,P as Y,Z as G}from"./index-dZzmvU5g.js";import{T as q,c as $,d as v,j as T,k as m,E,l as J,S as z,e as K,r as I,n as X,i as Z,h as b,p as Q,P as ee,a as se,b as te,V as ne,I as re,q as oe,f as ie}from"./content-checkbox-Dn63vLpE.js";import{g as ae,S as D}from"./useSeason-BsfHUol_.js";import{C as le,V as ce}from"./content-name-badge-C1L9RK7K.js";import{B as de}from"./checkbox-B-QTHQeG.js";import{S as ue}from"./cars-DD5O4eVH.js";import{F as y}from"./index-CTYY_hqn.js";import"./index-DiS1clUK.js";var f=(s=>(s.TracksUsed="TracksUsed",s.WishlistPanel="WishlistPanel",s))(f||{});function he({tab:s,setTab:r,...o}){return e.jsx(W,{...o,children:e.jsx(q,{size:"sm",value:s,onValueChange:t=>r(t.value),variant:"enclosed",width:"100%",flex:1,children:e.jsxs($,{flex:1,width:"100%",children:[e.jsx(v,{value:"TracksUsed",width:"100%",children:e.jsx(a,{textWrap:"nowrap",children:"Tracks Used"})}),e.jsx(v,{value:"WishlistPanel",width:"100%",children:e.jsx(a,{textWrap:"nowrap",children:"Wishlist"})})]})})})}function xe(){const{favoriteSeries:s}=k();return e.jsx(T,{bgColor:"transparent",children:e.jsx(m,{colSpan:8,minWidth:"100%",children:e.jsx(C,{justifyContent:"start",height:"100%",children:e.jsx(E,{icon:e.jsx(p,{icon:R}),title:s.length>0?"No paid tracks missing":"No series selected",description:s.length>0?"You already own all tracks of your favorite series":"You didn't choose any favorite series"})})})})}function pe({item:s}){const{myTracks:r,wishTracks:o}=k();return e.jsxs(T,{bgColor:"transparent",children:[e.jsx(m,{textAlign:"center",p:0,borderBottom:0,px:"4px",children:e.jsx(J,{size:"sm",mt:"2px",content:"tracks",sku:s.sku,contentId:s.id,free:!1,owned:r.includes(s==null?void 0:s.sku),wish:o.includes(s==null?void 0:s.sku)})}),e.jsx(m,{width:"100%",display:"flex",p:1,borderBottom:0,px:"4px",children:e.jsx(le,{name:s.name})}),e.jsx(m,{textAlign:"center",p:1,borderBottom:0,px:"4px",children:e.jsx(g,{lazyMount:!0,unmountOnExit:!0,content:Object.keys(s.weeks).map(t=>e.jsxs(h,{justifyContent:"space-between",children:[e.jsx(a,{textAlign:"left",truncate:!0,children:z[t.toString()].name}),e.jsx(a,{textAlign:"right",children:s.weeks[parseInt(t)].join(", ")})]},t)),showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,children:e.jsxs(de,{size:"xs",variant:"solid",_light:{bg:"gray.600"},children:[s.used,"x"]})})})]})}function je(){const{wishTracks:s,favoriteSeries:r}=k(),{onScroll:o}=B(),t=j.useMemo(()=>r.reduce((n,i)=>{const l=z[i.toString()];return l.weeks.forEach(x=>{const c=K[x.track.id.toString()];if(c.free)return n;const u="group"in c?c.group:c.id;n[u]=n[u]??{id:u,name:c.name,sku:c.sku,weeks:{},used:0};const O=ae(x.date);n[u].weeks[l.id]=n[u].weeks[l.id]??[],n[u].weeks[l.id].push(O),n[u].used++},null),n},{}),[r]),d=j.useMemo(()=>Object.values(t).sort((n,i)=>i.used+Object.keys(i.weeks).length-(n.used+Object.keys(n.weeks).length)).concat(s.map(n=>{const i=I.find(l=>l.sku===n);return i&&!(i.id in t)?{id:i.id,name:i.name,sku:i.sku,weeks:{},used:0}:null}).filter(n=>!!n)),[t]);return e.jsx(C,{flex:1,borderRadius:"md",overflowY:"auto",maxH:"100%",h:d.length>0?void 0:"100%",alignItems:"start",onScroll:o,children:e.jsxs(X,{striped:!0,stickyHeader:!0,height:"100%",borderRadius:"md",width:"100%",children:[e.jsx(Z,{children:e.jsxs(T,{bgColor:"bg.muted",children:[e.jsx(b,{textAlign:"center",children:e.jsx(ce,{children:"Owned content"})}),e.jsx(b,{width:"100%",children:"Name"}),e.jsx(b,{textAlign:"center",children:"Used"})]})}),e.jsx(Q,{children:e.jsx(A,{fallback:e.jsx(xe,{}),each:d,children:n=>e.jsx(pe,{item:n},n.id)})})]})})}function ge(){const{shopLoyaltyDiscount:s,shopVolumeDiscount:r}=P();return e.jsxs(ee,{positioning:{placement:"left-start"},children:[e.jsx(se,{asChild:!0,children:e.jsx(V,{"aria-label":"Settings",variant:"outline",size:"lg",bgColor:{base:"bg.muted",_hover:"bg"},borderRadius:"md",children:e.jsx(p,{icon:F})})}),e.jsx(te,{children:e.jsxs(ne,{alignItems:"start",p:2,children:[e.jsxs(h,{children:[e.jsx(g,{lazyMount:!0,unmountOnExit:!0,content:"Apply iRacing discounts for bundle purchases",showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,ids:{trigger:"volumeDiscount"},children:e.jsx(D,{ids:{root:"volumeDiscount"},checked:r,onCheckedChange:({checked:o})=>M(o),children:"Volume discount"})}),e.jsx(g,{lazyMount:!0,unmountOnExit:!0,content:"Go to iRacing's official Volume Discounts blog post",showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,children:e.jsx(H,{href:"https://www.iracing.com/volume-discounts/",target:"_blank",rel:"noreferrer",children:e.jsx(p,{icon:U})})})]}),e.jsx(g,{lazyMount:!0,unmountOnExit:!0,content:"Apply iRacing loyalty discount",showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,ids:{trigger:"loyaltyDiscount"},children:e.jsx(D,{ids:{root:"loyaltyDiscount"},checked:s,onCheckedChange:({checked:o})=>_(o),children:"Loyalty discount"})})]})})]})}function me({wishList:s}){return e.jsxs(N,{id:"checkout",as:"a",disabled:s.length<1,size:"lg",href:s.length>0?`${re.store}?skus=${s.map(r=>r.sku)}`:void 0,target:"_blank",rel:"noreferrer",colorPalette:"blue",children:["Checkout on iRacing.com store",e.jsx(p,{icon:U})]})}function ye({wishList:s}){const{shopLoyaltyDiscount:r,shopVolumeDiscount:o}=P(),t=j.useMemo(()=>s.reduce((x,c)=>x+c.price,0),[s]),d=s.filter(x=>x.price>6).length,n=r?20:o?d<3?0:d<6?10:d<20?15:20:0,i=t*n/100,l=t-i;return e.jsxs(h,{mt:2,justifyContent:"space-between",fontWeight:"bold",alignItems:"end",children:[e.jsx(a,{textStyle:"4xl",children:"Total"}),e.jsxs(w,{alignItems:"end",gap:0,children:[(o||r)&&e.jsxs(e.Fragment,{children:[e.jsxs(h,{color:"gray",children:[e.jsx(y,{style:"currency",currency:"USD",value:t}),e.jsx(a,{children:"-"}),e.jsx(y,{style:"currency",currency:"USD",value:i})]}),e.jsxs(a,{color:"gray",textAlign:"center",textStyle:"xs",fontWeight:"normal",children:[n,"% discount (",r?"loyalty":`${d} items`,")"]}),e.jsx(S,{mt:1})]}),e.jsx(a,{fontSize:"2xl",children:e.jsx(y,{style:"currency",currency:"USD",value:l})})]})]})}function fe(){const{wishCars:s,wishTracks:r}=k(),o=j.useMemo(()=>I.filter(t=>r.includes(t.sku)).map(t=>({...t,isCar:!1})).concat(ue.filter(t=>s.includes(t.sku)).map(t=>({...t,isCar:!0}))),[r,s]);return e.jsxs(w,{flex:1,borderRadius:"md",w:"100%",h:"100%",maxH:"100%",bgColor:"bg.muted",p:4,children:[e.jsxs(h,{justifyContent:"space-between",children:[e.jsx(a,{textStyle:"3xl",children:"Wishlist"}),e.jsx(ge,{})]}),e.jsxs(w,{overflowY:"auto",flex:1,fontSize:{base:"sm",md:"md"},gap:{base:1,md:2},children:[e.jsx(S,{}),e.jsx(A,{fallback:e.jsx(E,{icon:e.jsx(p,{icon:R}),title:"Empty wishlist",description:"Add some cars or tracks to your wishlist"}),each:o,children:t=>e.jsxs(j.Fragment,{children:[e.jsxs(h,{children:[e.jsx(p,{icon:t.isCar?L:Y,size:"sm"}),e.jsx(C,{flex:1,children:t.name}),e.jsx(y,{style:"currency",currency:"USD",value:t.price})]}),e.jsx(S,{})]},t.id)})]}),e.jsx(ye,{wishList:o}),e.jsx(me,{wishList:o})]})}function Re(){const[s,r]=j.useState(f.TracksUsed),{width:o}=G();return e.jsxs(oe,{children:[e.jsx(ie,{title:"Shop Guide",description:`See the tracks most used by your favorite series. Checkout your
          wishlist items at iracing.com`,children:e.jsx(he,{hideFrom:"md",tab:s,setTab:r})}),e.jsxs(h,{flex:1,alignItems:"start",overflow:"hidden",gap:2,children:[(s===f.TracksUsed||o.md)&&e.jsx(je,{}),(s===f.WishlistPanel||o.md)&&e.jsx(fe,{})]})]})}export{Re as default};
