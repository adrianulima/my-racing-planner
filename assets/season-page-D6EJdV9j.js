import{a as ve,r as c,j as h,F as ct,T as lt,s as Zn,b as er,c as tr,d as nr,e as rr,g as or,h as sr,i as ir,k as ar,l as cr,m as lr,H as jt,I as ur,n as ie,o as dr,p as fr,E as St,q as V,u as pe,S as It,t as hr,v as dn,w as fn,L as gr,x as Kt,y as Gt,z as vr,A as pr,R as $,B as Pe,f as br,C as mr,D as wr,G as xr,J as hn,K as Ct,M as yr,N as Sr,O as gn,P as Cr,Q as Rr,U as Dr,V as vn}from"./index-BOlLdPuj.js";import{V as Be,P as pn,a as bn,b as mn,T as kr,c as Er,d as Tr,e as At,f as jr,E as wn,g as Ir,o as xn,h as yn,i as Ar,j as Sn,I as Or,k as Ot,C as Mr,w as Nr,l as Lr,m as $r,n as zr,p as Pr}from"./content-checkbox-coc1i1AZ.js";import{C as Br}from"./icons-DxNg5zvp.js";import{S as Hr,g as Fr,f as Wr,u as Ur}from"./useSeason-CNcc_Tgg.js";import{C as Xr,c as Yr}from"./content-popover-CZoozL5Y.js";import{L as _r}from"./license-badge-C2A9CTR4.js";import{C as bt}from"./cars-DAFZD8GO.js";import"./index-DiS1clUK.js";import"./checkbox-CZkn8mVQ.js";function qr(){const{seasonShowReorder:e,seasonShowCheckboxes:t,seasonShowCarsDropdown:n,seasonShowTrackConfig:r,seasonHighlight:o,seasonShowThisWeek:s,seasonShowWishlist:i,seasonShowOwned:a,seasonShowParticipation:l,seasonShowRain:u,seasonUseLocalTimezone:d}=ve(),f=c.useMemo(()=>Intl.DateTimeFormat().resolvedOptions().timeZone||"Local",[d]),g=[{id:"checkboxes",text:"Show content checkboxes",tooltip:"Show track checkboxes to quickly switch tracks you own",checked:t,setChecked:Zn},{id:"cars",text:"Show cars dropdown",tooltip:"Show cars dropdown to quickly switch cars you own",checked:n,setChecked:er},{id:"config",text:"Show track config",tooltip:"Show track configuration used that week",checked:r,setChecked:tr},{id:"hover",text:"Highlight on track hover",tooltip:"Highlight all cells with the same hovered track",checked:o,setChecked:nr},{id:"reorder",text:"Reorder columns",tooltip:"Enable series columns reordering",checked:e,setChecked:rr},{id:"thisWeek",text:"Highlight current week",tooltip:"Highlight current week row",checked:s,setChecked:or},{id:"wishlist",text:"Show wishlist",tooltip:"Either wishlist items should be colored",checked:i,setChecked:sr},{id:"owned",text:"Show owned",tooltip:"Either owned items should be colored",checked:a,setChecked:ir},{id:"minParticipation",text:"Show participation credit program",tooltip:"Either series you have enough tracks to get reward should be colored",checked:l,setChecked:ar},{id:"rain",text:"Show rain chance",tooltip:"Show rain indicators for tracks with chance of rain",checked:u,setChecked:cr},{id:"localTimezone",text:`Schedule with ${f} time`,tooltip:"Convert race times from UTC to your local time zone",checked:d,setChecked:lr}];return h.jsx(Be,{alignItems:"start",p:2,children:h.jsx(ct,{each:g,children:v=>h.jsx(lt,{lazyMount:!0,unmountOnExit:!0,content:v.tooltip,showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,ids:{trigger:v.id},children:h.jsx(Hr,{ids:{root:v.id},checked:v.checked,onCheckedChange:({checked:m})=>v.setChecked(m),children:v.text})},v.id)})})}function Vr(){const{seasonCategory:e}=ve();return h.jsxs(jt,{justifyContent:{md:"space-between",base:"center"},mb:2,children:[h.jsxs(pn,{positioning:{placement:"right-start"},children:[h.jsx(bn,{asChild:!0,children:h.jsx(ur,{"aria-label":"Settings",variant:"outline",size:"lg",bgColor:{base:"bg.muted",_hover:"bg"},borderRadius:"md",children:h.jsx(ie,{icon:dr})})}),h.jsx(mn,{children:h.jsx(qr,{})})]}),h.jsx(kr,{size:"sm",value:e,onValueChange:t=>fr(t.value),variant:"enclosed",width:{md:"unset",base:"100%"},flex:{md:"unset",base:1},children:h.jsx(Er,{flex:{md:"unset",base:1},width:{md:"unset",base:"100%"},children:Object.entries(St).map(([t,n])=>h.jsxs(Tr,{value:n,width:{md:"unset",base:"100%"},children:[h.jsx(Br,{category:t}),h.jsx(V,{hideBelow:n==="All"?void 0:"md",textWrap:"nowrap",userSelect:"none",children:n})]},n))})})]})}function Kr({filteredFavorites:e}){const{myTracks:t,wishTracks:n}=pe(),r=c.useMemo(()=>{let o=0,s=0,i=0,a=0,l=0,u=0;const d=new Set;return e.forEach(f=>{var v;(((v=It[f.toString()])==null?void 0:v.weeks)??[]).forEach(m=>{const p=At[m.track.id.toString()];p&&(p.free&&o++,t.includes(p.sku)&&s++,n.includes(p.sku)&&i++,d.has(String(p.sku))||(p.free&&a++,t.includes(p.sku)&&l++,n.includes(p.sku)&&u++),d.add(String(p.sku)))})}),{free:o,owned:s,wish:i,uniqueFree:a,uniqueOwned:l,uniqueWish:u}},[t,n,e]);return h.jsx(jr,{freeCount:`${r.uniqueFree} (${r.free}x)`,ownedCount:`${r.uniqueOwned} (${r.owned}x)`,wishCount:`${r.uniqueWish} (${r.wish}x)`,title:"My Season Planner",description:"Plan your season weeks from your favorite series, use the settings dropdown options to customize the table."})}function Gr(){const[e,t]=hr();return h.jsx(dn,{flex:1,borderRadius:"md",bgColor:"bg.muted",p:4,justifyContent:"center",children:h.jsx(wn,{icon:h.jsx(ie,{icon:fn}),title:"No series selected",description:"You didn't choose any favorite series",children:h.jsxs(gr,{variant:"marker",children:[h.jsx(Kt,{children:h.jsx(Gt,{onClick:()=>vr(!1),children:"Read the Help Page instructions"})}),h.jsx(Kt,{onClick:()=>t(pr.MySeries),children:h.jsx(Gt,{children:"Go directly to the My Series page"})})]})})})}function Jr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const ut=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ee(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Mt(e){return"nodeType"in e}function P(e){var t,n;return e?Ee(e)?e:Mt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Nt(e){const{Document:t}=P(e);return e instanceof t}function Ye(e){return Ee(e)?!1:e instanceof P(e).HTMLElement}function Cn(e){return e instanceof P(e).SVGElement}function Te(e){return e?Ee(e)?e.document:Mt(e)?Nt(e)?e:Ye(e)||Cn(e)?e.ownerDocument:document:document:document}const ee=ut?c.useLayoutEffect:c.useEffect;function Lt(e){const t=c.useRef(e);return ee(()=>{t.current=e}),c.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function Qr(){const e=c.useRef(null),t=c.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=c.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ue(e,t){t===void 0&&(t=[e]);const n=c.useRef(e);return ee(()=>{n.current!==e&&(n.current=e)},t),n}function _e(e,t){const n=c.useRef();return c.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function ot(e){const t=Lt(e),n=c.useRef(null),r=c.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,r]}function Rt(e){const t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}let mt={};function qe(e,t){return c.useMemo(()=>{if(t)return t;const n=mt[e]==null?0:mt[e]+1;return mt[e]=n,e+"-"+n},[e,t])}function Rn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,i)=>{const a=Object.entries(i);for(const[l,u]of a){const d=s[l];d!=null&&(s[l]=d+e*u)}return s},{...t})}}const De=Rn(1),st=Rn(-1);function Zr(e){return"clientX"in e&&"clientY"in e}function $t(e){if(!e)return!1;const{KeyboardEvent:t}=P(e.target);return t&&e instanceof t}function eo(e){if(!e)return!1;const{TouchEvent:t}=P(e.target);return t&&e instanceof t}function Dt(e){if(eo(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Zr(e)?{x:e.clientX,y:e.clientY}:null}const ke=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[ke.Translate.toString(e),ke.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Jt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function to(e){return e.matches(Jt)?e:e.querySelector(Jt)}const no={display:"none"};function ro(e){let{id:t,value:n}=e;return $.createElement("div",{id:t,style:no},n)}function oo(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return $.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function so(){const[e,t]=c.useState("");return{announce:c.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Dn=c.createContext(null);function io(e){const t=c.useContext(Dn);c.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function ao(){const[e]=c.useState(()=>new Set),t=c.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[c.useCallback(r=>{let{type:o,event:s}=r;e.forEach(i=>{var a;return(a=i[o])==null?void 0:a.call(i,s)})},[e]),t]}const co={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},lo={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function uo(e){let{announcements:t=lo,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=co}=e;const{announce:s,announcement:i}=so(),a=qe("DndLiveRegion"),[l,u]=c.useState(!1);if(c.useEffect(()=>{u(!0)},[]),io(c.useMemo(()=>({onDragStart(f){let{active:g}=f;s(t.onDragStart({active:g}))},onDragMove(f){let{active:g,over:v}=f;t.onDragMove&&s(t.onDragMove({active:g,over:v}))},onDragOver(f){let{active:g,over:v}=f;s(t.onDragOver({active:g,over:v}))},onDragEnd(f){let{active:g,over:v}=f;s(t.onDragEnd({active:g,over:v}))},onDragCancel(f){let{active:g,over:v}=f;s(t.onDragCancel({active:g,over:v}))}}),[s,t])),!l)return null;const d=$.createElement($.Fragment,null,$.createElement(ro,{id:r,value:o.draggable}),$.createElement(oo,{id:a,announcement:i}));return n?Pe.createPortal(d,n):d}var A;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(A||(A={}));function it(){}function fo(e,t){return c.useMemo(()=>({sensor:e,options:{}}),[e,t])}function ho(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const K=Object.freeze({x:0,y:0});function go(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function vo(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function po(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function bo(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Qt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const mo=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Qt(t,t.left,t.top),s=[];for(const i of r){const{id:a}=i,l=n.get(a);if(l){const u=go(Qt(l),o);s.push({id:a,data:{droppableContainer:i,value:u}})}}return s.sort(vo)};function wo(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),i=o-r,a=s-n;if(r<o&&n<s){const l=t.width*t.height,u=e.width*e.height,d=i*a,f=d/(l+u-d);return Number(f.toFixed(4))}return 0}const xo=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:i}=s,a=n.get(i);if(a){const l=wo(a,t);l>0&&o.push({id:i,data:{droppableContainer:s,value:l}})}}return o.sort(po)};function yo(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function kn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:K}function So(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((i,a)=>({...i,top:i.top+e*a.y,bottom:i.bottom+e*a.y,left:i.left+e*a.x,right:i.right+e*a.x}),{...n})}}const Co=So(1);function Ro(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Do(e,t,n){const r=Ro(t);if(!r)return e;const{scaleX:o,scaleY:s,x:i,y:a}=r,l=e.left-i-(1-o)*parseFloat(n),u=e.top-a-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),d=o?e.width/o:e.width,f=s?e.height/s:e.height;return{width:d,height:f,top:u,right:l+d,bottom:u+f,left:l}}const ko={ignoreTransform:!1};function je(e,t){t===void 0&&(t=ko);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=P(e).getComputedStyle(e);u&&(n=Do(n,u,d))}const{top:r,left:o,width:s,height:i,bottom:a,right:l}=n;return{top:r,left:o,width:s,height:i,bottom:a,right:l}}function Zt(e){return je(e,{ignoreTransform:!0})}function Eo(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function To(e,t){return t===void 0&&(t=P(e).getComputedStyle(e)),t.position==="fixed"}function jo(e,t){t===void 0&&(t=P(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function zt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(Nt(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Ye(o)||Cn(o)||n.includes(o))return n;const s=P(e).getComputedStyle(o);return o!==e&&jo(o,s)&&n.push(o),To(o,s)?n:r(o.parentNode)}return e?r(e):n}function En(e){const[t]=zt(e,1);return t??null}function wt(e){return!ut||!e?null:Ee(e)?e:Mt(e)?Nt(e)||e===Te(e).scrollingElement?window:Ye(e)?e:null:null}function Tn(e){return Ee(e)?e.scrollX:e.scrollLeft}function jn(e){return Ee(e)?e.scrollY:e.scrollTop}function kt(e){return{x:Tn(e),y:jn(e)}}var M;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(M||(M={}));function In(e){return!ut||!e?!1:e===document.scrollingElement}function An(e){const t={x:0,y:0},n=In(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,i=e.scrollTop>=r.y,a=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:i,isRight:a,maxScroll:r,minScroll:t}}const Io={x:.2,y:.2};function Ao(e,t,n,r,o){let{top:s,left:i,right:a,bottom:l}=n;r===void 0&&(r=10),o===void 0&&(o=Io);const{isTop:u,isBottom:d,isLeft:f,isRight:g}=An(e),v={x:0,y:0},m={x:0,y:0},p={height:t.height*o.y,width:t.width*o.x};return!u&&s<=t.top+p.height?(v.y=M.Backward,m.y=r*Math.abs((t.top+p.height-s)/p.height)):!d&&l>=t.bottom-p.height&&(v.y=M.Forward,m.y=r*Math.abs((t.bottom-p.height-l)/p.height)),!g&&a>=t.right-p.width?(v.x=M.Forward,m.x=r*Math.abs((t.right-p.width-a)/p.width)):!f&&i<=t.left+p.width&&(v.x=M.Backward,m.x=r*Math.abs((t.left+p.width-i)/p.width)),{direction:v,speed:m}}function Oo(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:i}=window;return{top:0,left:0,right:s,bottom:i,width:s,height:i}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function On(e){return e.reduce((t,n)=>De(t,kt(n)),K)}function Mo(e){return e.reduce((t,n)=>t+Tn(n),0)}function No(e){return e.reduce((t,n)=>t+jn(n),0)}function Lo(e,t){if(t===void 0&&(t=je),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);En(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const $o=[["x",["left","right"],Mo],["y",["top","bottom"],No]];class Pt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=zt(n),o=On(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,i,a]of $o)for(const l of i)Object.defineProperty(this,l,{get:()=>{const u=a(r),d=o[s]-u;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class He{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function zo(e){const{EventTarget:t}=P(e);return e instanceof t?e:Te(e)}function xt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Y;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Y||(Y={}));function en(e){e.preventDefault()}function Po(e){e.stopPropagation()}var k;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(k||(k={}));const Mn={start:[k.Space,k.Enter],cancel:[k.Esc],end:[k.Space,k.Enter,k.Tab]},Bo=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case k.Right:return{...n,x:n.x+25};case k.Left:return{...n,x:n.x-25};case k.Down:return{...n,y:n.y+25};case k.Up:return{...n,y:n.y-25}}};class Nn{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new He(Te(n)),this.windowListeners=new He(P(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Y.Resize,this.handleCancel),this.windowListeners.add(Y.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Y.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Lo(r),n(K)}handleKeyDown(t){if($t(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=Mn,coordinateGetter:i=Bo,scrollBehavior:a="smooth"}=o,{code:l}=t;if(s.end.includes(l)){this.handleEnd(t);return}if(s.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:u}=r.current,d=u?{x:u.left,y:u.top}:K;this.referenceCoordinates||(this.referenceCoordinates=d);const f=i(t,{active:n,context:r.current,currentCoordinates:d});if(f){const g=st(f,d),v={x:0,y:0},{scrollableAncestors:m}=r.current;for(const p of m){const b=t.code,{isTop:w,isRight:C,isLeft:x,isBottom:R,maxScroll:D,minScroll:E}=An(p),S=Oo(p),y={x:Math.min(b===k.Right?S.right-S.width/2:S.right,Math.max(b===k.Right?S.left:S.left+S.width/2,f.x)),y:Math.min(b===k.Down?S.bottom-S.height/2:S.bottom,Math.max(b===k.Down?S.top:S.top+S.height/2,f.y))},I=b===k.Right&&!C||b===k.Left&&!x,O=b===k.Down&&!R||b===k.Up&&!w;if(I&&y.x!==f.x){const j=p.scrollLeft+g.x,_=b===k.Right&&j<=D.x||b===k.Left&&j>=E.x;if(_&&!g.y){p.scrollTo({left:j,behavior:a});return}_?v.x=p.scrollLeft-j:v.x=b===k.Right?p.scrollLeft-D.x:p.scrollLeft-E.x,v.x&&p.scrollBy({left:-v.x,behavior:a});break}else if(O&&y.y!==f.y){const j=p.scrollTop+g.y,_=b===k.Down&&j<=D.y||b===k.Up&&j>=E.y;if(_&&!g.x){p.scrollTo({top:j,behavior:a});return}_?v.y=p.scrollTop-j:v.y=b===k.Down?p.scrollTop-D.y:p.scrollTop-E.y,v.y&&p.scrollBy({top:-v.y,behavior:a});break}}this.handleMove(t,De(st(f,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Nn.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Mn,onActivation:o}=t,{active:s}=n;const{code:i}=e.nativeEvent;if(r.start.includes(i)){const a=s.activatorNode.current;return a&&e.target!==a?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function tn(e){return!!(e&&"distance"in e)}function nn(e){return!!(e&&"delay"in e)}class Bt{constructor(t,n,r){var o;r===void 0&&(r=zo(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:i}=s;this.props=t,this.events=n,this.document=Te(i),this.documentListeners=new He(this.document),this.listeners=new He(r),this.windowListeners=new He(P(i)),this.initialCoordinates=(o=Dt(s))!=null?o:K,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Y.Resize,this.handleCancel),this.windowListeners.add(Y.DragStart,en),this.windowListeners.add(Y.VisibilityChange,this.handleCancel),this.windowListeners.add(Y.ContextMenu,en),this.documentListeners.add(Y.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(nn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(tn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Y.Click,Po,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Y.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:i,options:{activationConstraint:a}}=s;if(!o)return;const l=(n=Dt(t))!=null?n:K,u=st(o,l);if(!r&&a){if(tn(a)){if(a.tolerance!=null&&xt(u,a.tolerance))return this.handleCancel();if(xt(u,a.distance))return this.handleStart()}if(nn(a)&&xt(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}t.cancelable&&t.preventDefault(),i(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===k.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Ho={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ht extends Bt{constructor(t){const{event:n}=t,r=Te(n.target);super(t,Ho,r)}}Ht.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Fo={move:{name:"mousemove"},end:{name:"mouseup"}};var Et;(function(e){e[e.RightClick=2]="RightClick"})(Et||(Et={}));class Wo extends Bt{constructor(t){super(t,Fo,Te(t.event.target))}}Wo.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Et.RightClick?!1:(r==null||r({event:n}),!0)}}];const yt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Uo extends Bt{constructor(t){super(t,yt)}static setup(){return window.addEventListener(yt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(yt.move.name,t)};function t(){}}}Uo.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var Fe;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Fe||(Fe={}));var at;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(at||(at={}));function Xo(e){let{acceleration:t,activator:n=Fe.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:i=5,order:a=at.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:g}=e;const v=_o({delta:f,disabled:!s}),[m,p]=Qr(),b=c.useRef({x:0,y:0}),w=c.useRef({x:0,y:0}),C=c.useMemo(()=>{switch(n){case Fe.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Fe.DraggableRect:return o}},[n,o,l]),x=c.useRef(null),R=c.useCallback(()=>{const E=x.current;if(!E)return;const S=b.current.x*w.current.x,y=b.current.y*w.current.y;E.scrollBy(S,y)},[]),D=c.useMemo(()=>a===at.TreeOrder?[...u].reverse():u,[a,u]);c.useEffect(()=>{if(!s||!u.length||!C){p();return}for(const E of D){if((r==null?void 0:r(E))===!1)continue;const S=u.indexOf(E),y=d[S];if(!y)continue;const{direction:I,speed:O}=Ao(E,y,C,t,g);for(const j of["x","y"])v[j][I[j]]||(O[j]=0,I[j]=0);if(O.x>0||O.y>0){p(),x.current=E,m(R,i),b.current=O,w.current=I;return}}b.current={x:0,y:0},w.current={x:0,y:0},p()},[t,R,r,p,s,i,JSON.stringify(C),JSON.stringify(v),m,u,D,d,JSON.stringify(g)])}const Yo={x:{[M.Backward]:!1,[M.Forward]:!1},y:{[M.Backward]:!1,[M.Forward]:!1}};function _o(e){let{delta:t,disabled:n}=e;const r=Rt(t);return _e(o=>{if(n||!r||!o)return Yo;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[M.Backward]:o.x[M.Backward]||s.x===-1,[M.Forward]:o.x[M.Forward]||s.x===1},y:{[M.Backward]:o.y[M.Backward]||s.y===-1,[M.Forward]:o.y[M.Forward]||s.y===1}}},[n,t,r])}function qo(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return _e(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function Vo(e,t){return c.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,r)}));return[...n,...s]},[]),[e,t])}var Xe;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Xe||(Xe={}));var Tt;(function(e){e.Optimized="optimized"})(Tt||(Tt={}));const rn=new Map;function Ko(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,i]=c.useState(null),{frequency:a,measure:l,strategy:u}=o,d=c.useRef(e),f=b(),g=Ue(f),v=c.useCallback(function(w){w===void 0&&(w=[]),!g.current&&i(C=>C===null?w:C.concat(w.filter(x=>!C.includes(x))))},[g]),m=c.useRef(null),p=_e(w=>{if(f&&!n)return rn;if(!w||w===rn||d.current!==e||s!=null){const C=new Map;for(let x of e){if(!x)continue;if(s&&s.length>0&&!s.includes(x.id)&&x.rect.current){C.set(x.id,x.rect.current);continue}const R=x.node.current,D=R?new Pt(l(R),R):null;x.rect.current=D,D&&C.set(x.id,D)}return C}return w},[e,s,n,f,l]);return c.useEffect(()=>{d.current=e},[e]),c.useEffect(()=>{f||v()},[n,f]),c.useEffect(()=>{s&&s.length>0&&i(null)},[JSON.stringify(s)]),c.useEffect(()=>{f||typeof a!="number"||m.current!==null||(m.current=setTimeout(()=>{v(),m.current=null},a))},[a,f,v,...r]),{droppableRects:p,measureDroppableContainers:v,measuringScheduled:s!=null};function b(){switch(u){case Xe.Always:return!1;case Xe.BeforeDragging:return n;default:return!n}}}function Ln(e,t){return _e(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Go(e,t){return Ln(e,t)}function Jo(e){let{callback:t,disabled:n}=e;const r=Lt(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return c.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function dt(e){let{callback:t,disabled:n}=e;const r=Lt(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return c.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function Qo(e){return new Pt(je(e),e)}function on(e,t,n){t===void 0&&(t=Qo);const[r,o]=c.useState(null);function s(){o(l=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=l??n)!=null?u:null}const d=t(e);return JSON.stringify(l)===JSON.stringify(d)?l:d})}const i=Jo({callback(l){if(e)for(const u of l){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),a=dt({callback:s});return ee(()=>{s(),e?(a==null||a.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),i==null||i.disconnect())},[e]),r}function Zo(e){const t=Ln(e);return kn(e,t)}const sn=[];function es(e){const t=c.useRef(e),n=_e(r=>e?r&&r!==sn&&e&&t.current&&e.parentNode===t.current.parentNode?r:zt(e):sn,[e]);return c.useEffect(()=>{t.current=e},[e]),n}function ts(e){const[t,n]=c.useState(null),r=c.useRef(e),o=c.useCallback(s=>{const i=wt(s.target);i&&n(a=>a?(a.set(i,kt(i)),new Map(a)):null)},[]);return c.useEffect(()=>{const s=r.current;if(e!==s){i(s);const a=e.map(l=>{const u=wt(l);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,kt(u)]):null}).filter(l=>l!=null);n(a.length?new Map(a):null),r.current=e}return()=>{i(e),i(s)};function i(a){a.forEach(l=>{const u=wt(l);u==null||u.removeEventListener("scroll",o)})}},[o,e]),c.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,i)=>De(s,i),K):On(e):K,[e,t])}function an(e,t){t===void 0&&(t=[]);const n=c.useRef(null);return c.useEffect(()=>{n.current=null},t),c.useEffect(()=>{const r=e!==K;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?st(e,n.current):K}function ns(e){c.useEffect(()=>{if(!ut)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function rs(e,t){return c.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=i=>{s(i,t)},n},{}),[e,t])}function $n(e){return c.useMemo(()=>e?Eo(e):null,[e])}const cn=[];function os(e,t){t===void 0&&(t=je);const[n]=e,r=$n(n?P(n):null),[o,s]=c.useState(cn);function i(){s(()=>e.length?e.map(l=>In(l)?r:new Pt(t(l),l)):cn)}const a=dt({callback:i});return ee(()=>{a==null||a.disconnect(),i(),e.forEach(l=>a==null?void 0:a.observe(l))},[e]),o}function ss(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ye(t)?t:e}function is(e){let{measure:t}=e;const[n,r]=c.useState(null),o=c.useCallback(u=>{for(const{target:d}of u)if(Ye(d)){r(f=>{const g=t(d);return f?{...f,width:g.width,height:g.height}:g});break}},[t]),s=dt({callback:o}),i=c.useCallback(u=>{const d=ss(u);s==null||s.disconnect(),d&&(s==null||s.observe(d)),r(d?t(d):null)},[t,s]),[a,l]=ot(i);return c.useMemo(()=>({nodeRef:a,rect:n,setRef:l}),[n,a,l])}const as=[{sensor:Ht,options:{}},{sensor:Nn,options:{}}],cs={current:{}},rt={draggable:{measure:Zt},droppable:{measure:Zt,strategy:Xe.WhileDragging,frequency:Tt.Optimized},dragOverlay:{measure:je}};class We extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const ls={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new We,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:it},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:rt,measureDroppableContainers:it,windowRect:null,measuringScheduled:!1},us={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:it,draggableNodes:new Map,over:null,measureDroppableContainers:it},ft=c.createContext(us),zn=c.createContext(ls);function ds(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new We}}}function fs(e,t){switch(t.type){case A.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case A.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case A.DragEnd:case A.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case A.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new We(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case A.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new We(e.droppable.containers);return i.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:i}}}case A.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new We(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function hs(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=c.useContext(ft),s=Rt(r),i=Rt(n==null?void 0:n.id);return c.useEffect(()=>{if(!t&&!r&&s&&i!=null){if(!$t(s)||document.activeElement===s.target)return;const a=o.get(i);if(!a)return;const{activatorNode:l,node:u}=a;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[l.current,u.current]){if(!d)continue;const f=to(d);if(f){f.focus();break}}})}},[r,t,o,i,s]),null}function gs(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function vs(e){return c.useMemo(()=>({draggable:{...rt.draggable,...e==null?void 0:e.draggable},droppable:{...rt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...rt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function ps(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=c.useRef(!1),{x:i,y:a}=typeof o=="boolean"?{x:o,y:o}:o;ee(()=>{if(!i&&!a||!t){s.current=!1;return}if(s.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=n(u),f=kn(d,r);if(i||(f.x=0),a||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const g=En(u);g&&g.scrollBy({top:f.y,left:f.x})}},[t,i,a,r,n])}const Pn=c.createContext({...K,scaleX:1,scaleY:1});var he;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(he||(he={}));const bs=c.memo(function(t){var n,r,o,s;let{id:i,accessibility:a,autoScroll:l=!0,children:u,sensors:d=as,collisionDetection:f=xo,measuring:g,modifiers:v,...m}=t;const p=c.useReducer(fs,void 0,ds),[b,w]=p,[C,x]=ao(),[R,D]=c.useState(he.Uninitialized),E=R===he.Initialized,{draggable:{active:S,nodes:y,translate:I},droppable:{containers:O}}=b,j=S!=null?y.get(S):null,_=c.useRef({initial:null,translated:null}),q=c.useMemo(()=>{var L;return S!=null?{id:S,data:(L=j==null?void 0:j.data)!=null?L:cs,rect:_}:null},[S,j]),G=c.useRef(null),[Ie,Ve]=c.useState(null),[B,Ke]=c.useState(null),te=Ue(m,Object.values(m)),Ae=qe("DndDescribedBy",i),Ge=c.useMemo(()=>O.getEnabled(),[O]),z=vs(g),{droppableRects:ne,measureDroppableContainers:ge,measuringScheduled:Oe}=Ko(Ge,{dragging:E,dependencies:[I.x,I.y],config:z.droppable}),U=qo(y,S),Je=c.useMemo(()=>B?Dt(B):null,[B]),ae=Qn(),re=Go(U,z.draggable.measure);ps({activeNode:S!=null?y.get(S):null,config:ae.layoutShiftCompensation,initialRect:re,measure:z.draggable.measure});const T=on(U,z.draggable.measure,re),Me=on(U?U.parentElement:null),J=c.useRef({activatorEvent:null,active:null,activeNode:U,collisionRect:null,collisions:null,droppableRects:ne,draggableNodes:y,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),be=O.getNodeFor((n=J.current.over)==null?void 0:n.id),oe=is({measure:z.dragOverlay.measure}),me=(r=oe.nodeRef.current)!=null?r:U,we=E?(o=oe.rect)!=null?o:T:null,Ft=!!(oe.nodeRef.current&&oe.rect),Wt=Zo(Ft?null:T),gt=$n(me?P(me):null),ce=es(E?be??U:null),Qe=os(ce),Ze=gs(v,{transform:{x:I.x-Wt.x,y:I.y-Wt.y,scaleX:1,scaleY:1},activatorEvent:B,active:q,activeNodeRect:T,containerNodeRect:Me,draggingNodeRect:we,over:J.current.over,overlayNodeRect:oe.rect,scrollableAncestors:ce,scrollableAncestorRects:Qe,windowRect:gt}),Ut=Je?De(Je,I):null,Xt=ts(ce),Yn=an(Xt),_n=an(Xt,[T]),xe=De(Ze,Yn),ye=we?Co(we,Ze):null,Ne=q&&ye?f({active:q,collisionRect:ye,droppableRects:ne,droppableContainers:Ge,pointerCoordinates:Ut}):null,Yt=bo(Ne,"id"),[le,_t]=c.useState(null),qn=Ft?Ze:De(Ze,_n),Vn=yo(qn,(s=le==null?void 0:le.rect)!=null?s:null,T),vt=c.useRef(null),qt=c.useCallback((L,H)=>{let{sensor:F,options:ue}=H;if(G.current==null)return;const X=y.get(G.current);if(!X)return;const W=L.nativeEvent,Q=new F({active:G.current,activeNode:X,event:W,options:ue,context:J,onAbort(N){if(!y.get(N))return;const{onDragAbort:Z}=te.current,se={id:N};Z==null||Z(se),C({type:"onDragAbort",event:se})},onPending(N,de,Z,se){if(!y.get(N))return;const{onDragPending:$e}=te.current,fe={id:N,constraint:de,initialCoordinates:Z,offset:se};$e==null||$e(fe),C({type:"onDragPending",event:fe})},onStart(N){const de=G.current;if(de==null)return;const Z=y.get(de);if(!Z)return;const{onDragStart:se}=te.current,Le={activatorEvent:W,active:{id:de,data:Z.data,rect:_}};Pe.unstable_batchedUpdates(()=>{se==null||se(Le),D(he.Initializing),w({type:A.DragStart,initialCoordinates:N,active:de}),C({type:"onDragStart",event:Le}),Ve(vt.current),Ke(W)})},onMove(N){w({type:A.DragMove,coordinates:N})},onEnd:Se(A.DragEnd),onCancel:Se(A.DragCancel)});vt.current=Q;function Se(N){return async function(){const{active:Z,collisions:se,over:Le,scrollAdjustedTranslate:$e}=J.current;let fe=null;if(Z&&$e){const{cancelDrop:ze}=te.current;fe={activatorEvent:W,active:Z,collisions:se,delta:$e,over:Le},N===A.DragEnd&&typeof ze=="function"&&await Promise.resolve(ze(fe))&&(N=A.DragCancel)}G.current=null,Pe.unstable_batchedUpdates(()=>{w({type:N}),D(he.Uninitialized),_t(null),Ve(null),Ke(null),vt.current=null;const ze=N===A.DragEnd?"onDragEnd":"onDragCancel";if(fe){const pt=te.current[ze];pt==null||pt(fe),C({type:ze,event:fe})}})}}},[y]),Kn=c.useCallback((L,H)=>(F,ue)=>{const X=F.nativeEvent,W=y.get(ue);if(G.current!==null||!W||X.dndKit||X.defaultPrevented)return;const Q={active:W};L(F,H.options,Q)===!0&&(X.dndKit={capturedBy:H.sensor},G.current=ue,qt(F,H))},[y,qt]),Vt=Vo(d,Kn);ns(d),ee(()=>{T&&R===he.Initializing&&D(he.Initialized)},[T,R]),c.useEffect(()=>{const{onDragMove:L}=te.current,{active:H,activatorEvent:F,collisions:ue,over:X}=J.current;if(!H||!F)return;const W={active:H,activatorEvent:F,collisions:ue,delta:{x:xe.x,y:xe.y},over:X};Pe.unstable_batchedUpdates(()=>{L==null||L(W),C({type:"onDragMove",event:W})})},[xe.x,xe.y]),c.useEffect(()=>{const{active:L,activatorEvent:H,collisions:F,droppableContainers:ue,scrollAdjustedTranslate:X}=J.current;if(!L||G.current==null||!H||!X)return;const{onDragOver:W}=te.current,Q=ue.get(Yt),Se=Q&&Q.rect.current?{id:Q.id,rect:Q.rect.current,data:Q.data,disabled:Q.disabled}:null,N={active:L,activatorEvent:H,collisions:F,delta:{x:X.x,y:X.y},over:Se};Pe.unstable_batchedUpdates(()=>{_t(Se),W==null||W(N),C({type:"onDragOver",event:N})})},[Yt]),ee(()=>{J.current={activatorEvent:B,active:q,activeNode:U,collisionRect:ye,collisions:Ne,droppableRects:ne,draggableNodes:y,draggingNode:me,draggingNodeRect:we,droppableContainers:O,over:le,scrollableAncestors:ce,scrollAdjustedTranslate:xe},_.current={initial:we,translated:ye}},[q,U,Ne,ye,y,me,we,ne,O,le,ce,xe]),Xo({...ae,delta:I,draggingRect:ye,pointerCoordinates:Ut,scrollableAncestors:ce,scrollableAncestorRects:Qe});const Gn=c.useMemo(()=>({active:q,activeNode:U,activeNodeRect:T,activatorEvent:B,collisions:Ne,containerNodeRect:Me,dragOverlay:oe,draggableNodes:y,droppableContainers:O,droppableRects:ne,over:le,measureDroppableContainers:ge,scrollableAncestors:ce,scrollableAncestorRects:Qe,measuringConfiguration:z,measuringScheduled:Oe,windowRect:gt}),[q,U,T,B,Ne,Me,oe,y,O,ne,le,ge,ce,Qe,z,Oe,gt]),Jn=c.useMemo(()=>({activatorEvent:B,activators:Vt,active:q,activeNodeRect:T,ariaDescribedById:{draggable:Ae},dispatch:w,draggableNodes:y,over:le,measureDroppableContainers:ge}),[B,Vt,q,T,w,Ae,y,le,ge]);return $.createElement(Dn.Provider,{value:x},$.createElement(ft.Provider,{value:Jn},$.createElement(zn.Provider,{value:Gn},$.createElement(Pn.Provider,{value:Vn},u)),$.createElement(hs,{disabled:(a==null?void 0:a.restoreFocus)===!1})),$.createElement(uo,{...a,hiddenTextDescribedById:Ae}));function Qn(){const L=(Ie==null?void 0:Ie.autoScrollEnabled)===!1,H=typeof l=="object"?l.enabled===!1:l===!1,F=E&&!L&&!H;return typeof l=="object"?{...l,enabled:F}:{enabled:F}}}),ms=c.createContext(null),ln="button",ws="Draggable";function xs(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=qe(ws),{activators:i,activatorEvent:a,active:l,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:g}=c.useContext(ft),{role:v=ln,roleDescription:m="draggable",tabIndex:p=0}=o??{},b=(l==null?void 0:l.id)===t,w=c.useContext(b?Pn:ms),[C,x]=ot(),[R,D]=ot(),E=rs(i,t),S=Ue(n);ee(()=>(f.set(t,{id:t,key:s,node:C,activatorNode:R,data:S}),()=>{const I=f.get(t);I&&I.key===s&&f.delete(t)}),[f,t]);const y=c.useMemo(()=>({role:v,tabIndex:p,"aria-disabled":r,"aria-pressed":b&&v===ln?!0:void 0,"aria-roledescription":m,"aria-describedby":d.draggable}),[r,v,p,b,m,d.draggable]);return{active:l,activatorEvent:a,activeNodeRect:u,attributes:y,isDragging:b,listeners:r?void 0:E,node:C,over:g,setNodeRef:x,setActivatorNodeRef:D,transform:w}}function ys(){return c.useContext(zn)}const Ss="Droppable",Cs={timeout:25};function Rs(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=qe(Ss),{active:i,dispatch:a,over:l,measureDroppableContainers:u}=c.useContext(ft),d=c.useRef({disabled:n}),f=c.useRef(!1),g=c.useRef(null),v=c.useRef(null),{disabled:m,updateMeasurementsFor:p,timeout:b}={...Cs,...o},w=Ue(p??r),C=c.useCallback(()=>{if(!f.current){f.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{u(Array.isArray(w.current)?w.current:[w.current]),v.current=null},b)},[b]),x=dt({callback:C,disabled:m||!i}),R=c.useCallback((y,I)=>{x&&(I&&(x.unobserve(I),f.current=!1),y&&x.observe(y))},[x]),[D,E]=ot(R),S=Ue(t);return c.useEffect(()=>{!x||!D.current||(x.disconnect(),f.current=!1,x.observe(D.current))},[D,x]),c.useEffect(()=>(a({type:A.RegisterDroppable,element:{id:r,key:s,disabled:n,node:D,rect:g,data:S}}),()=>a({type:A.UnregisterDroppable,key:s,id:r})),[r]),c.useEffect(()=>{n!==d.current.disabled&&(a({type:A.SetDroppableDisabled,id:r,key:s,disabled:n}),d.current.disabled=n)},[r,s,n,a]),{active:i,rect:g,isOver:(l==null?void 0:l.id)===r,node:D,over:l,setNodeRef:E}}const Ds=e=>{let{transform:t}=e;return{...t,y:0}};function ht(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function ks(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function et(e){return e!==null&&e>=0}function Es(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ts(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const tt={scaleX:1,scaleY:1},js=e=>{var t;let{rects:n,activeNodeRect:r,activeIndex:o,overIndex:s,index:i}=e;const a=(t=n[o])!=null?t:r;if(!a)return null;const l=Is(n,i,o);if(i===o){const u=n[s];return u?{x:o<s?u.left+u.width-(a.left+a.width):u.left-a.left,y:0,...tt}:null}return i>o&&i<=s?{x:-a.width-l,y:0,...tt}:i<o&&i>=s?{x:a.width+l,y:0,...tt}:{x:0,y:0,...tt}};function Is(e,t,n){const r=e[t],o=e[t-1],s=e[t+1];return!r||!o&&!s?0:n<t?o?r.left-(o.left+o.width):s.left-(r.left+r.width):s?s.left-(r.left+r.width):r.left-(o.left+o.width)}const Bn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=ht(t,r,n),i=t[o],a=s[o];return!a||!i?null:{x:a.left-i.left,y:a.top-i.top,scaleX:a.width/i.width,scaleY:a.height/i.height}},Hn="Sortable",Fn=$.createContext({activeIndex:-1,containerId:Hn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Bn,disabled:{draggable:!1,droppable:!1}});function As(e){let{children:t,id:n,items:r,strategy:o=Bn,disabled:s=!1}=e;const{active:i,dragOverlay:a,droppableRects:l,over:u,measureDroppableContainers:d}=ys(),f=qe(Hn,n),g=a.rect!==null,v=c.useMemo(()=>r.map(E=>typeof E=="object"&&"id"in E?E.id:E),[r]),m=i!=null,p=i?v.indexOf(i.id):-1,b=u?v.indexOf(u.id):-1,w=c.useRef(v),C=!Es(v,w.current),x=b!==-1&&p===-1||C,R=Ts(s);ee(()=>{C&&m&&d(v)},[C,v,m,d]),c.useEffect(()=>{w.current=v},[v]);const D=c.useMemo(()=>({activeIndex:p,containerId:f,disabled:R,disableTransforms:x,items:v,overIndex:b,useDragOverlay:g,sortedRects:ks(v,l),strategy:o}),[p,f,R.draggable,R.droppable,x,v,b,l,g,o]);return $.createElement(Fn.Provider,{value:D},t)}const Os=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return ht(n,r,o).indexOf(t)},Ms=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:i,previousItems:a,previousContainerId:l,transition:u}=e;return!u||!r||a!==s&&o===i?!1:n?!0:i!==o&&t===l},Ns={duration:200,easing:"ease"},Wn="transform",Ls=ke.Transition.toString({property:Wn,duration:0,easing:"linear"}),$s={roleDescription:"sortable"};function zs(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,i]=c.useState(null),a=c.useRef(n);return ee(()=>{if(!t&&n!==a.current&&r.current){const l=o.current;if(l){const u=je(r.current,{ignoreTransform:!0}),d={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(d.x||d.y)&&i(d)}}n!==a.current&&(a.current=n)},[t,n,r,o]),c.useEffect(()=>{s&&i(null)},[s]),s}function Un(e){let{animateLayoutChanges:t=Ms,attributes:n,disabled:r,data:o,getNewIndex:s=Os,id:i,strategy:a,resizeObserverConfig:l,transition:u=Ns}=e;const{items:d,containerId:f,activeIndex:g,disabled:v,disableTransforms:m,sortedRects:p,overIndex:b,useDragOverlay:w,strategy:C}=c.useContext(Fn),x=Ps(r,v),R=d.indexOf(i),D=c.useMemo(()=>({sortable:{containerId:f,index:R,items:d},...o}),[f,o,R,d]),E=c.useMemo(()=>d.slice(d.indexOf(i)),[d,i]),{rect:S,node:y,isOver:I,setNodeRef:O}=Rs({id:i,data:D,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...l}}),{active:j,activatorEvent:_,activeNodeRect:q,attributes:G,setNodeRef:Ie,listeners:Ve,isDragging:B,over:Ke,setActivatorNodeRef:te,transform:Ae}=xs({id:i,data:D,attributes:{...$s,...n},disabled:x.draggable}),Ge=Jr(O,Ie),z=!!j,ne=z&&!m&&et(g)&&et(b),ge=!w&&B,Oe=ge&&ne?Ae:null,Je=ne?Oe??(a??C)({rects:p,activeNodeRect:q,activeIndex:g,overIndex:b,index:R}):null,ae=et(g)&&et(b)?s({id:i,items:d,activeIndex:g,overIndex:b}):R,re=j==null?void 0:j.id,T=c.useRef({activeId:re,items:d,newIndex:ae,containerId:f}),Me=d!==T.current.items,J=t({active:j,containerId:f,isDragging:B,isSorting:z,id:i,index:R,items:d,newIndex:T.current.newIndex,previousItems:T.current.items,previousContainerId:T.current.containerId,transition:u,wasDragging:T.current.activeId!=null}),be=zs({disabled:!J,index:R,node:y,rect:S});return c.useEffect(()=>{z&&T.current.newIndex!==ae&&(T.current.newIndex=ae),f!==T.current.containerId&&(T.current.containerId=f),d!==T.current.items&&(T.current.items=d)},[z,ae,f,d]),c.useEffect(()=>{if(re===T.current.activeId)return;if(re!=null&&T.current.activeId==null){T.current.activeId=re;return}const me=setTimeout(()=>{T.current.activeId=re},50);return()=>clearTimeout(me)},[re]),{active:j,activeIndex:g,attributes:G,data:D,rect:S,index:R,newIndex:ae,items:d,isOver:I,isSorting:z,isDragging:B,listeners:Ve,node:y,overIndex:b,over:Ke,setNodeRef:Ge,setActivatorNodeRef:te,setDroppableNodeRef:O,setDraggableNodeRef:Ie,transform:be??Je,transition:oe()};function oe(){if(be||Me&&T.current.newIndex===R)return Ls;if(!(ge&&!$t(_)||!u)&&(z||J))return ke.Transition.toString({...u,property:Wn})}}function Ps(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}k.Down,k.Right,k.Up,k.Left;function un(e,t=0){if(!e||!e.firstSessionTime)return"Schedule information unavailable";const n=e.firstSessionTime.substring(0,5);let[r,o]=n.split(":").map(Number);const s=r*60+o+t;r=Math.floor(s/60)%24,o=s%60;const i=e.repeatMinutes||0;return Bs(e.dayOffset)?Fs(r,o,i):Hs(e.dayOffset)?Ws(r,o,i):e.dayOffset.length===1?`Races on ${Ys(e.startDate,e.dayOffset[0])}, ${Xs(r,o,i)}`:Us(e,r,o,i,t)}function Bs(e){if(e.length!==7)return!1;for(let t=0;t<7;t++)if(!e.includes(t))return!1;return!0}function Hs(e){if(e.length<=1)return!1;const t=new Set(e.map(n=>n%7));return t.size===1||t.size<=2&&e.length>=3}function Fs(e,t,n){return n===15?"Races every 15 minutes":n===30?t===0?"Races every 30 minutes at :00 and :30":t===15?"Races every 30 minutes at :15 and :45":`Races every 30 minutes starting at ${Re(t)} past the hour`:n===60?t===0?"Races every hour at :00":t===45?"Races every hour at :45":`Races every hour at :${Re(t)}`:n===120?e%2===0?t===0?"Races every even 2 hours at :00":t===45?"Races every even 2 hours at :45":`Races every even 2 hours at :${Re(t)}`:t===0?"Races every odd 2 hours at :00":t===45?"Races every odd 2 hours at :45":`Races every odd 2 hours at :${Re(t)}`:`Races every ${n} minutes`}function Ws(e,t,n){return n===0?`Races weekly at ${Ce(e,t)}`:n===60?`Races weekly every hour starting at ${Ce(e,t)}`:n===120?`Races weekly every 2 hours starting at ${Ce(e,t)}`:`Races weekly every ${n} minutes starting at ${Ce(e,t)}`}function Us(e,t,n,r,o=0){const s=e.dayOffset.map(a=>{const l=new Date(e.startDate);if(l.setDate(l.getDate()+a),o!==0){const[u,d]=e.firstSessionTime.split(":").map(Number);l.setHours(u,d,0,0),l.setMinutes(l.getMinutes()+o)}return l.toLocaleDateString("en-US",{weekday:"long"})}),i=Ce(t,n);return r===0?`Races at ${i} on ${nt(s)}`:r===60?`Races every hour on ${nt(s)} starting at ${i}`:r===120?`Races every 2 hours on ${nt(s)} starting at ${i}`:`Races every ${r} minutes on ${nt(s)} starting at ${i}`}function Xs(e,t,n){const r=Ce(e,t);return n===0?`at ${r}`:n===60?t===0?"every hour at :00":t===45?"every hour at :45":`every hour at :${Re(t)}`:n===120?e%2===0?t===45?"every even 2 hours at :45":`every even 2 hours starting at ${r}`:t===45?"every odd 2 hours at :45":`every odd 2 hours starting at ${r}`:n===30?t===0?"every 30 minutes at :00 and :30 past":t===15?"every 30 minutes at :15 and :45":`every 30 minutes starting at ${r}`:`every ${n} minutes starting at ${r}`}function Ce(e,t){e=(e%24+24)%24;const n=e>=12?"pm":"am";return`${e%12||12}:${Re(t)}${n}`}function Re(e){return e=(e%60+60)%60,e.toString().padStart(2,"0")}function nt(e){if(e.length===0)return"";if(e.length===1)return e[0];if(e.length===2)return`${e[0]} and ${e[1]}`;const t=e[e.length-1];return`${e.slice(0,-1).join(", ")}, and ${t}`}function Ys(e,t){const n=new Date(e);return n.setDate(n.getDate()+t),n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function _s(e,t=0){if(!e||e.length===0)return"No scheduled races";const n=e.filter(r=>r&&r.repeating&&r.firstSessionTime&&r.dayOffset);return n.length===0?"Schedule information unavailable":n.length===1?un(n[0],t):n.map((r,o)=>`Schedule ${o+1}: ${un(r,t)}`).join(`
`)}function Xn({cars:e,...t}){return h.jsxs(pn,{lazyMount:!0,unmountOnExit:!0,children:[h.jsx(bn,{asChild:!0,children:h.jsxs(jt,{gap:1,justifyContent:"center",cursor:"pointer",position:"absolute",right:1,top:1,px:2,rounded:"4px",bgColor:"bg.muted",...t,children:[h.jsx(ie,{icon:br}),e.length,h.jsx(ie,{icon:mr})]})}),h.jsxs(mn,{p:2,children:[h.jsx(Ir,{}),h.jsx(Xr,{content:"cars",list:e})]})]})}const qs=.66;function Vs({seriesTracks:e}){const{myTracks:t}=pe(),{numberOfTracks:n,tracksNeeded:r,enoughTracks:o}=c.useMemo(()=>{const a=Object.fromEntries(Object.entries(e).filter(([f])=>!f.includes("_cars")&&!f.includes("_rainChance"))),l=Object.values(a).map(f=>At[f.toString()]).filter(Boolean),u=Math.ceil(l.length*qs),d=l.filter(f=>f.free||t.includes(f.sku)||xn(f.id,t)).length;return{numberOfTracks:d,tracksNeeded:u,enoughTracks:d>=u}},[e,t]),s={base:o?"green.600":"red.600",_dark:o?"green.400":"red.400"},i={base:o?"green.50":"red.50",_dark:o?"green.800":"red.800"};return h.jsx(lt,{lazyMount:!0,unmountOnExit:!0,content:`Participation credit program: ${o?"Yes":"No"} (${n}/${r})`,showArrow:!0,positioning:{placement:"bottom"},openDelay:200,closeDelay:100,children:h.jsx(jt,{textStyle:"xs",color:s,bgColor:i,justifyContent:"center",position:"absolute",left:0,right:0,bottom:.5,px:2,children:h.jsxs(V,{children:[o?h.jsx(ie,{icon:wr}):h.jsx(ie,{icon:xr})," ",n," / ",r]})})})}function Ks({showDragButton:e,dragId:t,children:n,onClickSwap:r,...o}){const{attributes:s,listeners:i,setNodeRef:a,transform:l,transition:u,isDragging:d}=Un({id:t}),{width:f}=hn(),g=e&&!f.md&&!!r,v=e&&f.md;return h.jsxs(yn,{...o,ref:a,transform:ke.Transform.toString(l),transition:u,zIndex:d?10:void 0,children:[g&&h.jsx(Ct,{justifyContent:"center",position:"absolute",transform:"translate(-50%,-50%)",left:0,top:"50%",py:1,px:2,rounded:"full",cursor:"pointer",bg:"bg",color:"fg.muted",border:"fg.muted",borderWidth:1,onClick:r,children:h.jsx(ie,{size:"sm",icon:yr})}),v&&h.jsx(Ct,{justifyContent:"center",position:"absolute",left:1,top:1,px:2,rounded:"4px",cursor:d?"grabbing":"grab",color:"fg.muted",...s,...i,children:h.jsx(ie,{icon:Sr})}),n]})}function Gs({filteredFavorites:e,seriesDateMap:t}){const{seasonShowReorder:n,seasonShowCarsDropdown:r,seasonShowParticipation:o,seasonUseLocalTimezone:s}=ve(),{scrolled:i}=gn(),{favoriteSeries:a}=pe(),l=c.useMemo(()=>s?-new Date().getTimezoneOffset():0,[s]),u=d=>{vn(ht(a,d,d-1))};return h.jsx(Ar,{children:h.jsxs(Sn,{bgColor:"bg.muted",zIndex:"sticky",children:[h.jsx(yn,{textAlign:"center",width:"60px",bgColor:"bg.muted",position:"sticky",left:"0",zIndex:"sticky",children:"Week"}),h.jsx(ct,{each:e,children:(d,f)=>{const g=It[d.toString()],v=g&&Yr(g.laps,g.duration),m=(g==null?void 0:g.raceSchedule)&&_s(g.raceSchedule,l);return g&&h.jsxs(Ks,{dragId:d,showDragButton:n,onClickSwap:f!==0?()=>u(f):void 0,width:"(100/x)%",position:"relative",bgColor:"currentBg",children:[h.jsx(lt,{lazyMount:!0,unmountOnExit:!0,content:h.jsxs(Be,{children:[h.jsx(V,{textAlign:"center",lineClamp:"2",width:"100%",whiteSpace:"normal",wordBreak:"break-word",fontWeight:"bold",children:g.name}),h.jsxs(V,{textAlign:"center",width:"100%",whiteSpace:"normal",wordBreak:"break-word",children:[h.jsx(_r,{letter:g.license.letter,color:g.license.color,mr:"1",themeInverted:!0,children:g.license.letter}),v," race"]}),m&&h.jsx(Be,{children:h.jsx(V,{textAlign:"center",width:"100%",whiteSpace:"normal",wordBreak:"break-word",children:m})})]}),showArrow:!0,positioning:{placement:"bottom"},openDelay:200,closeDelay:100,children:h.jsxs(Be,{gap:1,pb:o&&!i?"12px":0,width:"100%",children:[g.logo&&h.jsx(Cr,{loading:"lazy",userSelect:"none",draggable:!1,h:"40px",fit:"contain",src:`${Or.image}/img/logos/series/${g.logo}`}),h.jsx(Rr,{open:!i,children:h.jsx(Dr,{style:{width:"100%"},children:h.jsx(Ct,{width:"100%",px:1,children:h.jsx(V,{textAlign:"center",lineClamp:"2",width:"100%",children:g.name})})})})]})}),o&&h.jsx(Vs,{seriesTracks:t[d]}),r&&h.jsx(Xn,{cars:g.cars})]},d)}})]})})}function Js({cars:e,...t}){const{myCars:n,wishCars:r}=pe(),o=e.some(l=>bt[l.toString()].free),s=e.some(l=>n.includes(bt[l.toString()].sku)),i=e.some(l=>r.includes(bt[l.toString()].sku)),a=e.length>0?{base:o?"green.400":s?"teal.400":i?"blue.400":"red.400",_dark:o?"green.600":s?"teal.600":i?"blue.600":"red.600"}:void 0;return h.jsx(Xn,{cars:e,bgColor:a,color:"fg",...t})}function Qs({dragId:e,children:t,...n}){const{setNodeRef:r,transform:o,transition:s,isDragging:i}=Un({id:e});return h.jsx(Ot,{...n,ref:r,transform:ke.Transform.toString(o),transition:s,zIndex:i?10:void 0,children:t})}function Zs({seriesId:e,wish:t,owned:n,free:r,id:o,name:s,config:i,sku:a,date:l,seriesDateMap:u,highlight:d,setHighlightTrack:f}){var y,I;const{seasonShowCheckboxes:g,seasonShowCarsDropdown:v,seasonShowTrackConfig:m,seasonHighlight:p,seasonShowWishlist:b,seasonShowOwned:w,seasonShowRain:C}=ve(),x=((y=u==null?void 0:u[e])==null?void 0:y[`${l}_cars`])||[],R=((I=u==null?void 0:u[e])==null?void 0:I[`${l}_rainChance`])||0,D={_dark:r?"green.400":w&&n?"teal.400":b&&t?"blue.400":"red.400",base:r?"green.600":w&&n?"teal.600":b&&t?"blue.600":"red.600"},E={base:r?"green.50":w&&n?"teal.50":b&&t?"blue.50":"red.50",_dark:r?"green.800":w&&n?"teal.800":b&&t?"blue.800":"red.800"},S={_dark:r?"green.900":w&&n?"teal.900":b&&t?"blue.900":"red.900",base:r?"green.200":w&&n?"teal.200":b&&t?"blue.200":"red.200"};return h.jsxs(Qs,{dragId:e,width:"(100/x)%",position:"relative",onMouseEnter:()=>p&&f(a),onMouseLeave:()=>p&&f(-1),bgColor:p&&d?S:E,color:D,children:[C&&R>0&&h.jsx(V,{position:"absolute",top:1,right:1,fontSize:"14px",lineHeight:"1",zIndex:"1",title:`${R}% chance of rain`,userSelect:"none",children:"💧"}),h.jsx(V,{userSelect:"none",textAlign:"center",lineClamp:"3",lineHeight:"18px",children:s}),m&&i&&h.jsxs(V,{userSelect:"none",textAlign:"center",lineClamp:"3",lineHeight:"12px",fontSize:"10px",pt:"2px",children:["(",i,")"]}),v&&x.length>0&&h.jsx(Js,{cars:x}),g&&h.jsx(Mr,{size:"xs",position:"absolute",left:1,top:1,content:"tracks",sku:a,contentId:o,free:r,owned:n,wish:t})]})}const ei=$.memo(Zs);function ti({date:e,thisWeek:t,weekNumber:n}){const r="en-US",o={year:"numeric",month:"long",day:"numeric"},s={month:"short",day:"numeric"},i=new Date(e),a=new Date(new Date(i).setUTCDate(i.getDate()+7));return h.jsx(Ot,{width:"60px",bgColor:t?"bg.inverted":"bg.muted",color:t?"bg":void 0,position:"sticky",left:"0",zIndex:"docked",children:h.jsx(lt,{lazyMount:!0,unmountOnExit:!0,content:`${i.toLocaleDateString(r,o)} - ${a.toLocaleDateString(r,o)}`,showArrow:!0,positioning:{placement:"top"},openDelay:200,closeDelay:100,children:h.jsxs(Be,{alignItems:"center",gap:0,children:[h.jsx(V,{textAlign:"center",children:i.toLocaleDateString("en-US",s)}),h.jsxs(V,{fontSize:"xs",textAlign:"center",opacity:"0.8",children:["(week ",n,")"]})]})})})}function ni({date:e,seriesDateMap:t,filteredFavorites:n,highlightTrack:r,setHighlightTrack:o,weekIndex:s}){const{myTracks:i,wishTracks:a}=pe(),{seasonShowThisWeek:l}=ve(),u=l&&Fr(Wr(new Date))===e;return h.jsxs(Sn,{bgColor:"bg.muted",height:"60px",borderYWidth:u?"2px":void 0,borderColor:u?"bg.inverted":void 0,children:[h.jsx(ti,{date:e,thisWeek:u,weekNumber:s+1}),h.jsx(ct,{each:n,children:d=>{var p;const f=(p=t==null?void 0:t[d])==null?void 0:p[e],g=At[f],v=g&&(a.includes(g.sku)||Nr(g.id,a,i)),m=g&&(i.includes(g.sku)||xn(g.id,i));return g?h.jsx(ei,{seriesId:d,trackId:f,wish:v,owned:m,free:g.free,id:g.id,name:g.name,config:g.config,sku:g.sku,date:e,seriesDateMap:t,highlight:r===(g==null?void 0:g.sku),setHighlightTrack:o},d):h.jsx(Ot,{width:"(100/x)%"},d)}})]},e)}const ri=$.memo(ni);function oi({filteredFavorites:e}){const{weeksStartDates:t,seriesDateMap:n}=Ur(),{favoriteSeries:r}=pe(),{seasonShowReorder:o}=ve(),[s,i]=c.useState(-1),{onScroll:a}=gn(),{width:l}=hn(),u=ho(fo(Ht));function d(f){const{active:g,over:v}=f;if(v&&(g==null?void 0:g.id)!==(v==null?void 0:v.id)){const m=r.indexOf(g.id),p=r.indexOf(v.id);vn(ht(r,m,p))}}return h.jsx(bs,{sensors:u,collisionDetection:mo,onDragEnd:d,modifiers:[Ds],children:h.jsx(As,{items:e,strategy:js,disabled:!o||!l.md,children:h.jsx(Lr,{borderRadius:"md",onScroll:a,children:h.jsxs($r,{size:"sm",showColumnBorder:!0,stickyHeader:!0,children:[h.jsx(Gs,{filteredFavorites:e,seriesDateMap:n}),h.jsx(zr,{children:h.jsx(ct,{each:t,children:(f,g)=>h.jsx(ri,{seriesDateMap:n,date:f,filteredFavorites:e,highlightTrack:s,setHighlightTrack:i,weekIndex:g},f)})})]})})})})}function si(){return h.jsx(dn,{flex:1,borderRadius:"md",bgColor:"bg.muted",p:4,children:h.jsx(wn,{icon:h.jsx(ie,{icon:fn}),title:"No series found",description:"Try different categories"})})}function vi(){const{favoriteSeries:e}=pe(),{seasonCategory:t}=ve(),[n,r]=c.useState(e);return c.useEffect(()=>{const o=t===St.all?e:e.filter(s=>St[(It[s.toString()]??{}).category]===t);r(o)},[t,e]),h.jsxs(Pr,{children:[h.jsx(Kr,{filteredFavorites:n}),e.length>0&&h.jsx(Vr,{}),e.length===0&&h.jsx(Gr,{}),e.length>0&&n.length===0&&h.jsx(si,{}),n.length>0&&h.jsx(oi,{filteredFavorites:n})]})}export{vi as default};
